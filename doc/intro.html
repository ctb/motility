<?xml version="1.0" encoding="utf-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="Docutils 0.4: http://docutils.sourceforge.net/" />
<title>motility: A C++/Python toolkit for sequence motif searching</title>
<style type="text/css">

/*
:Author: David Goodger
:Contact: goodger@users.sourceforge.net
:Date: $Date: 2005-12-18 01:56:14 +0100 (Sun, 18 Dec 2005) $
:Revision: $Revision: 4224 $
:Copyright: This stylesheet has been placed in the public domain.

Default cascading style sheet for the HTML output of Docutils.

See http://docutils.sf.net/docs/howto/html-stylesheets.html for how to
customize this style sheet.
*/

/* used to remove borders from tables and images */
.borderless, table.borderless td, table.borderless th {
  border: 0 }

table.borderless td, table.borderless th {
  /* Override padding for "table.docutils td" with "! important".
     The right padding separates the table cells. */
  padding: 0 0.5em 0 0 ! important }

.first {
  /* Override more specific margin styles with "! important". */
  margin-top: 0 ! important }

.last, .with-subtitle {
  margin-bottom: 0 ! important }

.hidden {
  display: none }

a.toc-backref {
  text-decoration: none ;
  color: black }

blockquote.epigraph {
  margin: 2em 5em ; }

dl.docutils dd {
  margin-bottom: 0.5em }

/* Uncomment (and remove this text!) to get bold-faced definition list terms
dl.docutils dt {
  font-weight: bold }
*/

div.abstract {
  margin: 2em 5em }

div.abstract p.topic-title {
  font-weight: bold ;
  text-align: center }

div.admonition, div.attention, div.caution, div.danger, div.error,
div.hint, div.important, div.note, div.tip, div.warning {
  margin: 2em ;
  border: medium outset ;
  padding: 1em }

div.admonition p.admonition-title, div.hint p.admonition-title,
div.important p.admonition-title, div.note p.admonition-title,
div.tip p.admonition-title {
  font-weight: bold ;
  font-family: sans-serif }

div.attention p.admonition-title, div.caution p.admonition-title,
div.danger p.admonition-title, div.error p.admonition-title,
div.warning p.admonition-title {
  color: red ;
  font-weight: bold ;
  font-family: sans-serif }

/* Uncomment (and remove this text!) to get reduced vertical space in
   compound paragraphs.
div.compound .compound-first, div.compound .compound-middle {
  margin-bottom: 0.5em }

div.compound .compound-last, div.compound .compound-middle {
  margin-top: 0.5em }
*/

div.dedication {
  margin: 2em 5em ;
  text-align: center ;
  font-style: italic }

div.dedication p.topic-title {
  font-weight: bold ;
  font-style: normal }

div.figure {
  margin-left: 2em ;
  margin-right: 2em }

div.footer, div.header {
  clear: both;
  font-size: smaller }

div.line-block {
  display: block ;
  margin-top: 1em ;
  margin-bottom: 1em }

div.line-block div.line-block {
  margin-top: 0 ;
  margin-bottom: 0 ;
  margin-left: 1.5em }

div.sidebar {
  margin-left: 1em ;
  border: medium outset ;
  padding: 1em ;
  background-color: #ffffee ;
  width: 40% ;
  float: right ;
  clear: right }

div.sidebar p.rubric {
  font-family: sans-serif ;
  font-size: medium }

div.system-messages {
  margin: 5em }

div.system-messages h1 {
  color: red }

div.system-message {
  border: medium outset ;
  padding: 1em }

div.system-message p.system-message-title {
  color: red ;
  font-weight: bold }

div.topic {
  margin: 2em }

h1.section-subtitle, h2.section-subtitle, h3.section-subtitle,
h4.section-subtitle, h5.section-subtitle, h6.section-subtitle {
  margin-top: 0.4em }

h1.title {
  text-align: center }

h2.subtitle {
  text-align: center }

hr.docutils {
  width: 75% }

img.align-left {
  clear: left }

img.align-right {
  clear: right }

ol.simple, ul.simple {
  margin-bottom: 1em }

ol.arabic {
  list-style: decimal }

ol.loweralpha {
  list-style: lower-alpha }

ol.upperalpha {
  list-style: upper-alpha }

ol.lowerroman {
  list-style: lower-roman }

ol.upperroman {
  list-style: upper-roman }

p.attribution {
  text-align: right ;
  margin-left: 50% }

p.caption {
  font-style: italic }

p.credits {
  font-style: italic ;
  font-size: smaller }

p.label {
  white-space: nowrap }

p.rubric {
  font-weight: bold ;
  font-size: larger ;
  color: maroon ;
  text-align: center }

p.sidebar-title {
  font-family: sans-serif ;
  font-weight: bold ;
  font-size: larger }

p.sidebar-subtitle {
  font-family: sans-serif ;
  font-weight: bold }

p.topic-title {
  font-weight: bold }

pre.address {
  margin-bottom: 0 ;
  margin-top: 0 ;
  font-family: serif ;
  font-size: 100% }

pre.literal-block, pre.doctest-block {
  margin-left: 2em ;
  margin-right: 2em ;
  background-color: #eeeeee }

span.classifier {
  font-family: sans-serif ;
  font-style: oblique }

span.classifier-delimiter {
  font-family: sans-serif ;
  font-weight: bold }

span.interpreted {
  font-family: sans-serif }

span.option {
  white-space: nowrap }

span.pre {
  white-space: pre }

span.problematic {
  color: red }

span.section-subtitle {
  /* font-size relative to parent (h1..h6 element) */
  font-size: 80% }

table.citation {
  border-left: solid 1px gray;
  margin-left: 1px }

table.docinfo {
  margin: 2em 4em }

table.docutils {
  margin-top: 0.5em ;
  margin-bottom: 0.5em }

table.footnote {
  border-left: solid 1px black;
  margin-left: 1px }

table.docutils td, table.docutils th,
table.docinfo td, table.docinfo th {
  padding-left: 0.5em ;
  padding-right: 0.5em ;
  vertical-align: top }

table.docutils th.field-name, table.docinfo th.docinfo-name {
  font-weight: bold ;
  text-align: left ;
  white-space: nowrap ;
  padding-left: 0 }

h1 tt.docutils, h2 tt.docutils, h3 tt.docutils,
h4 tt.docutils, h5 tt.docutils, h6 tt.docutils {
  font-size: 100% }

tt.docutils {
  background-color: #eeeeee }

ul.auto-toc {
  list-style-type: none }

</style>
</head>
<body>
<div class="document" id="motility-a-c-python-toolkit-for-sequence-motif-searching">
<h1 class="title">motility: A C++/Python toolkit for sequence motif searching</h1>
<p><strong>motility</strong> is a C++ library for searching DNA sequences with several
different types of motif representations, from the simplest case
(string literals!)  to IUPAC-style motifs (e.g. <tt class="docutils literal"><span class="pre">WGATAR</span></tt>),
Position-Weight Matrices (PWMs), and energy operators.  It also has
a simple Python interface which renders it almost immediately useful
from the command line.</p>
<p>See the associated <tt class="docutils literal"><span class="pre">c++-interface</span></tt> and <tt class="docutils literal"><span class="pre">python-interface</span></tt> docs for
more info on how to use this library from C++ or Python.</p>
<p><strong>motility</strong> is used both in FamilyRelations II (FRII) and in
a variety of ad-hoc script-writing projects.</p>
<div class="section">
<h1><a id="supported-motif-types" name="supported-motif-types">supported motif types</a></h1>
<p>There's really only a small set of motif representations that are used
in the Real World; here's a list of the ones that motility knows about.</p>
<dl class="docutils">
<dt><strong>string literals</strong></dt>
<dd><p class="first">This is the simplest kind of motif; <tt class="docutils literal"><span class="pre">GACCA</span></tt> matches
to either <tt class="docutils literal"><span class="pre">GACCA</span></tt> or its reverse complement <tt class="docutils literal"><span class="pre">TGGTC</span></tt>.</p>
<p class="last">In practice, you can do the same thing with IUPAC notation (below)
in a better and more flexible way, so the string literal functions
are not so useful, but it was good practice to write 'em ;).</p>
</dd>
<dt><strong>IUPAC notation</strong></dt>
<dd><p class="first">This notation is the same as string literals except that it permits
some uncertainty (or degeneracy) in each position: e.g. <tt class="docutils literal"><span class="pre">WGATAR</span></tt>
matches an A or a T, followed by a GATA, followed by an A or a G,
in both forward and reverse complement sequence.  See iupac <a class="reference" href="#symbols">symbols</a>
below.</p>
<p class="last">Please note that <em>motility</em> can also generate IUPAC matches with
an arbitrary number of mismatches.</p>
</dd>
<dt><strong>Position-Weight Matrices</strong></dt>
<dd><p class="first">Position-Weight Matrices (PWM) are matrix representations of
motifs that allows for fairly flexible matching to individual
bases.  For example, for the sequence 'WGATAR' the PWM would
look like</p>
<pre class="literal-block">
  ( A C G T )
1.  1 0 0 1
2.  0 0 1 0
3.  1 0 0 0
4.  0 0 0 1
5.  1 0 0 0
6.  1 0 1 0
</pre>
<p>and the PWM score for any given sequence would be the sum of the
scores in the matrix element corresponding to the letter in each
position, e.g. the score would be 6 for the sequence <tt class="docutils literal"><span class="pre">AGATAA</span></tt> and
the score would be 5 for the sequence <tt class="docutils literal"><span class="pre">CGATAA</span></tt>.</p>
<p>Because the weights can vary to any floating point value, fairly
subtle variations can be constructed to e.g. overemphasize core
sites in matches or underemphasize the centers of dimer binding sites.</p>
<p class="last">PWMs were developed by computer scientists, I think.</p>
</dd>
<dt><strong>Energy Operators</strong></dt>
<dd><p class="first">The inverse of position-weight matrices, in some sense.  It is another
matrix representation that allows for weighting of independent
bases, but the weights are the inverse of PWM weights: the <em>lower</em> the
match score, the better the match.  So, for example, the consensus
motif usually has a weight of 0 in a normalized energy operator matrix.</p>
<p>This notation was developed by physicists to mimic the binding
energy of proteins to DNA: if a DNA/protein binding interaction
is at a minimum along a given sequence, it is the most stable
interaction available to that protein.  Gibbs sampling tends to use
energy operator notation.</p>
<p class="last">Obviously PWMs and energy operators are interconvertible, but
it's done rather rarely because there's really no point in choosing
one over the other.  Also, if converting multiple motifs, you may
run into problems normalizing the maximum and minimum scores to
get comparable results.</p>
</dd>
</dl>
<hr class="docutils" />
<p id="symbols"><strong>IUPAC symbols:</strong></p>
<p>The following are the IUPAC symbols for nucleotides:</p>
<pre class="literal-block">
A            A           Adenine
C            C           Cytosine
G            G           Guanine
T            T           Thymine
U            U           Uracil
M          A or C
R          A or G
W          A or T
S          C or G
Y          C or T
K          G or T
V        A or C or G
H        A or C or T
D        A or G or T
B        C or G or T
N      G or A or T or C
</pre>
<p>Note that 'X' (normally the same as 'N') is not supported by motility
because it's silly.  If it's a problem let me know.</p>
<hr class="docutils" />
<p>Contact author: Titus Brown, <em>titus&#64;caltech.edu</em>.</p>
<pre class="literal-block">
7/2003
</pre>
</div>
</div>
</body>
</html>
